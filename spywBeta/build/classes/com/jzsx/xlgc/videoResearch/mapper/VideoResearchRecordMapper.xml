<?xml version="1.0" encoding="UTF-8" ?>   
<!DOCTYPE mapper   
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" 
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd"> 
<mapper  namespace="com.jzsx.xlgc.videoResearch.Dao.VideoResearchRecordDao">

	<resultMap type="com.jzsx.xlgc.bean.VideoResearchRecord" id="BaseResultMap">
	    <id property="videoResearchReId" column="t_videoResearchReId"/>
	    <result property="videoResearchReIp" column="t_videoResearchRe_ip" />
	    <result property="videoResearchTime" column="t_videoResearch_time" />
	    <result property="videoResearchRealName" column="t_videoResearch_realName" />
	    <result property="videoResearchCode" column="t_videoResearch_code" />
	    <result property="videoResearchType" column="T_VIDEORESEARCH_type" />
    </resultMap>
    <resultMap type="com.jzsx.xlgc.bean.VideoResearchRecord" id="BaseResultMap1">
	    <id property="videoResearchReId" column="t_videoResearchReId"/>
	    <result property="videoResearchReIp" column="t_videoResearchRe_ip" />
	    <result property="videoResearchTime" column="t_videoResearch_time" />
	    <result property="videoResearchRealName" column="t_videoResearch_realName" />
	    <result property="videoResearchCode" column="t_videoResearch_code" />
	    <result property="videoResearchTitle" column="videoResearchTitle" />
	    <association property="areainfo" column="t_videoResearch_code" select="com.jzsx.xlgc.area.Dao.AreaDao.queryByCode"></association>
    </resultMap>
  	<!-- 根据多个手机号查询多个会议成员的信息 -->
  	<select id="queryVideoResearchRecordList" resultMap="BaseResultMap">
        select * from t_video_research_record
    </select>
    <select id="queryByAll" parameterType="com.jzsx.xlgc.bean.VideoResearchRecord" resultMap="BaseResultMap1">
    	select  nvl(nvl(cu.realname,mu.realname),' ') as t_videoresearch_realname,rd.t_videoresearchreid,
      			 rd.t_videoresearchre_ip,rd.t_videoresearch_time,rd.t_videoresearch_code,
     			  rd.t_videoresearch_type ,rh.t_videoresearch_name as videoResearchTitle 
    	from t_video_research_record rd
		left join t_video_research rh on rh.t_videoresearchid=rd.t_videoresearchreid
		left join cas_user cu on to_char(cu.userid) || ''=rd.t_videoresearch_realname
    	left join common_user mu on mu.userid=rd.t_videoresearch_realname
 		where 1=1
	    	<if test="videoResearchReId != null and videoResearchReId !='' ">
				and	t_videoResearchReId=#{videoResearchReId}
			</if>
			<if test="videoResearchReIp != null and videoResearchReIp !=''">
				and t_videoResearchRe_ip=#{videoResearchReIp}
			</if>
			<if test="videoResearchTitle != null and videoResearchTitle !=''">
				and rh.t_videoresearch_name like '%${videoResearchTitle}%'
			</if>
			<if test="startDate !=null and startDate !='' ">
		   	 <![CDATA[
			   	 and to_date(rd.t_videoresearch_time,'yyyy-MM-dd hh24:mi:ss') >= #{startDate}
			   	 ]]>
		   	 </if>
		   	 <if test="stopDate !=null and stopDate !='' ">
		   	 <![CDATA[
			   	 and to_date(rd.t_videoresearch_time,'yyyy-MM-dd hh24:mi:ss') <= #{stopDate}
			   	 ]]>
		   	 </if>
		   	 order by rd.t_videoresearch_time desc
    </select>
    <select id="queyVideoResearchRecordById" parameterType="com.jzsx.xlgc.bean.VideoResearchRecord" resultMap="BaseResultMap">
    	select * from t_video_research_record where 1=1
	    	<if test="videoResearchReId != null and videoResearchReId !='' ">
				and	t_videoResearchReId=#{videoResearchReId}
			</if>
			<if test="videoResearchReIp != null and videoResearchReIp !=''">
				and t_videoResearchRe_ip=#{videoResearchReIp}
			</if>
			<if test="videoResearchTime != null and videoResearchTime !=''">
				and to_char(to_date(t_videoresearch_time,'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd')=#{videoResearchTime}
			</if>
			<if test="videoResearchType != null and videoResearchType !=''">
				and T_VIDEORESEARCH_type=#{videoResearchType}
			</if>
			<if test="videoResearchRealName != null and videoResearchRealName !=''">
				and t_videoResearch_realName=#{videoResearchRealName}
			</if>
    </select>
    <delete id="deleteByParentId" parameterType="java.lang.String">
    	delete from t_video_research_record where t_videoResearchReId=#{videoResearchReId}
    </delete>
	<insert id="insertActive" parameterType="com.jzsx.xlgc.bean.VideoResearchRecord">
		insert into t_video_research_record 
		<trim prefix="(" suffix=")" suffixOverrides="," >
			<if test="videoResearchReId != null and videoResearchReId !='' ">
				t_videoResearchReId,
			</if>
			<if test="videoResearchReIp != null and videoResearchReIp !=''">
				t_videoResearchRe_ip,
			</if>
			<if test="videoResearchTime != null and videoResearchTime !=''">
				t_videoResearch_time,
			</if>
			<if test="videoResearchRealName != null and videoResearchRealName !=''">
				t_videoResearch_realName,
			</if>
			<if test="videoResearchCode != null and videoResearchCode !=''">
				t_videoResearch_code,
			</if>
			<if test="videoResearchType != null and videoResearchType !=''">
				T_VIDEORESEARCH_type,
			</if>
		</trim>
		values
			<trim prefix="(" suffix=")" suffixOverrides="," >
			<if test="videoResearchReId != null and videoResearchReId !='' ">
				#{videoResearchReId},
			</if>
			<if test="videoResearchReIp != null and videoResearchReIp !=''">
				#{videoResearchReIp},
			</if>
			<if test="videoResearchTime != null and videoResearchTime !=''">
				#{videoResearchTime},
			</if>
			<if test="videoResearchRealName != null and videoResearchRealName !=''">
				#{videoResearchRealName},
			</if>
			<if test="videoResearchCode != null and videoResearchCode !=''">
				#{videoResearchCode},
			</if>
			<if test="videoResearchType != null and videoResearchType !=''">
				#{videoResearchType},
			</if>
			</trim>
	</insert>
	<delete id="deleteBytime" parameterType="java.lang.String">
		<![CDATA[
		delete from t_video_research_record where to_date(t_videoResearch_time,'yyyy-MM-dd') < to_date(#{videoResearchTime},'yyyy-MM-dd')
		]]>
	</delete>
</mapper>