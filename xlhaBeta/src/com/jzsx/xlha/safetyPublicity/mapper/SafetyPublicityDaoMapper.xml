<?xml version="1.0" encoding="UTF-8" ?>   
<!DOCTYPE mapper   
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" 
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd"> 
<mapper  namespace="com.jzsx.xlha.safetyPublicity.dao.SafetyPublicityDao">

	<resultMap type="com.jzsx.xlha.bean.SafetyPublicity" id="BaseResultMap">
	    <id property="safetyPyId" column="c_safetyPyId"/>
	    <result property="safetyPyUserName" column="c_safetyPy_username" />
	    <result property="safetyPyName" column="c_safetyPy_name" />
	    <result property="safetyPyType" column="c_safetyPy_type" />
	    <result property="safetyPyRemark" column="c_safetyPy_remark" />
	    <result property="safetyPyPath" column="c_safetyPy_path" />
	    <result property="safetyPyTime" column="c_safetyPy_time" />
	    <result property="safetyPyEditusername" column="c_safetyPy_editusername" />
	    <result property="safetyPyAuther" column="c_safetyPy_auther" />
	    <result property="safetyPyViewcount" column="c_safetyPy_viewcount" />
    </resultMap>
    <resultMap type="com.jzsx.xlha.bean.SafetyPublicity" id="BaseResultMapSafe">
	    <id property="safetyPyId" column="t_videoId"/>
	    <result property="safetyPyName" column="t_video_name" />
	    <result property="safetyPyType" column="t_video_pic_typeId" />
	    <result property="safetyPyPath" column="t_video_path" />
	    <result property="safetyPyRemark" column="t_video_remark" />
	    <result property="safetyPyTime" column="t_video_time" />
	    <result property="safetyPyUserName" column="t_video_realname" />
	    <result property="safetyPyAuther" column="t_video_realname" />
	    <result property="safetyPyViewcount" column="t_video_view_count" />
	    <result property="safetyPyEditusername" column="t_video_edit_username" />
    </resultMap>
  	<!-- 根据多个手机号查询多个会议成员的信息 -->
  	<select id="querylist" resultMap="BaseResultMap">
        select * from t_safety_publicity
    </select>
    <select id="querylistAll" parameterType="com.jzsx.xlha.bean.SafetyPublicity" resultMap="BaseResultMap">
	   	 select * from t_safety_publicity where 1=1
		   	 <if test="safetyPyName !=null and safetyPyName !='' ">
		   	 	and  c_safetyPy_name like '%${safetyPyName}%'
		   	 </if>
		   	 <if test="safetyPyStarttime !=null and safetyPyStarttime !='' ">
			   	 <![CDATA[
			   	 and c_safetyPy_time > #{safetyPyStarttime}
			   	 ]]>
		   	 </if>
		   	  <if test="safetyPyhStoptime !=null and safetyPyhStoptime !='' ">
		   	   <![CDATA[
			   	 and c_safetyPy_time < #{safetyPyhStoptime}
			   	 ]]>
		   	 </if>
		   	 order by c_safetyPy_time desc
    </select>
    <select id="queryById" parameterType="java.lang.String" resultMap="BaseResultMap">
    	select * from t_safety_publicity where c_safetyPyId=#{safetyPyId}
    </select>
    <delete id="deleteById" parameterType="java.lang.String">
    	delete from t_safety_publicity where c_safetyPyId=#{safetyPyId}
    </delete>
   <!-- 展示视频培训的数据集 -->
    <select id="querySafeByAll" parameterType="com.jzsx.xlha.bean.SafetyPublicity" resultMap="BaseResultMapSafe">
		select t_videoId,t_video_name,t_video_pic_typeId
	    	,t_video_path,
	      t_video_remark,t_video_time,t_video_realname,
	      t_video_view_count,t_video_edit_username 
	      from t_video_train
	      where 1=1
	      and t_video_typeId=6
	      <if test="safetyPyName !=null and safetyPyName !='' ">
		   	 	and  t_video_name like '%${safetyPyName}%'
	   	 </if>
	   	 <if test="safetyPyStarttime !=null and safetyPyStarttime !=''">
	      	<![CDATA[
				   	 and to_char(t_video_time,'yyyy-MM-dd') >= to_char(#{safetyPyStarttime},'yyyy-MM-dd')
			 ]]>
	      </if>
	      <if test="safetyPyhStoptime !=null and safetyPyhStoptime !=''">
	      	<![CDATA[
				   	 and to_char(t_video_time,'yyyy-MM-dd') <= to_char(#{safetyPyhStoptime},'yyyy-MM-dd')
			]]>
	      </if>
		   	 order by t_video_time desc
	</select>
	<select id="querySafeById" parameterType="java.lang.String" resultMap="BaseResultMapSafe">
    	select t_videoId,t_video_name,t_video_pic_typeId
	    	,t_video_path,
	      t_video_remark,t_video_time,t_video_realname,
	      t_video_view_count,t_video_edit_username 
	      from t_video_train
	     where 1=1
	    	 and t_video_typeId=6
	       and t_videoId=#{safetyPyId}
    </select>
    <update id="updateActiveSafeByViewCount" parameterType="com.jzsx.xlha.bean.SafetyPublicity">
		update t_video_train
		<set>
			<if test="safetyPyViewcount != null and safetyPyViewcount !=''">
				t_video_view_count=t_video_view_count+1,
			</if>
		</set>
		where 1=1 and t_video_typeId=6 and t_videoId=#{safetyPyId}
	</update>
	<insert id="insertActive" parameterType="com.jzsx.xlha.bean.SafetyPublicity">
		insert into t_safety_publicity 
		<trim prefix="(" suffix=")" suffixOverrides="," >
			<if test="safetyPyId != null and safetyPyId !='' ">
				c_safetyPyId,
			</if>
			<if test="safetyPyUserName != null and safetyPyUserName !=''">
				c_safetyPy_username,
			</if>
			<if test="safetyPyName != null and safetyPyName !=''">
				c_safetyPy_name,
			</if>
			<if test="safetyPyType != null and safetyPyType !=''">
				c_safetyPy_type,
			</if>
			<if test="safetyPyRemark != null and safetyPyRemark !=''">
				c_safetyPy_remark,
			</if>
			<if test="safetyPyPath != null and safetyPyPath !=''">
				c_safetyPy_path,
			</if>
			<if test="safetyPyTime != null and safetyPyTime !=''">
				c_safetyPy_time,
			</if>
			<if test="safetyPyEditusername != null and safetyPyEditusername !=''">
				c_safetyPy_editusername,
			</if>
			<if test="safetyPyAuther != null and safetyPyAuther !=''">
				c_safetyPy_auther,
			</if>
			<if test="safetyPyViewcount != null and safetyPyViewcount !=''">
				c_safetyPy_viewcount,
			</if>
		</trim>
		values
			<trim prefix="(" suffix=")" suffixOverrides="," >
			<if test="safetyPyId != null and safetyPyId !='' ">
				#{safetyPyId},
			</if>
			<if test="safetyPyUserName != null and safetyPyUserName !=''">
				#{safetyPyUserName},
			</if>
			<if test="safetyPyName != null and safetyPyName !=''">
				#{safetyPyName},
			</if>
			<if test="safetyPyType != null and safetyPyType !=''">
				#{safetyPyType},
			</if>
			<if test="safetyPyRemark != null and safetyPyRemark !=''">
				#{safetyPyRemark},
			</if>
			<if test="safetyPyPath != null and safetyPyPath !=''">
				#{safetyPyPath},
			</if>
			<if test="safetyPyTime != null and safetyPyTime !=''">
				#{safetyPyTime},
			</if>
			<if test="safetyPyEditusername != null and safetyPyEditusername !=''">
				#{safetyPyEditusername},
			</if>
			<if test="safetyPyAuther != null and safetyPyAuther !=''">
				#{safetyPyAuther},
			</if>
			<if test="safetyPyViewcount != null and safetyPyViewcount !=''">
				#{safetyPyViewcount},
			</if>
			</trim>
	</insert>
	<update id="updateActive" parameterType="com.jzsx.xlha.bean.SafetyPublicity">
		update t_safety_publicity
		<set>
			<if test="safetyPyUserName != null and safetyPyUserName !=''">
				c_safetyPy_username=#{safetyPyUserName},
			</if>
			<if test="safetyPyName != null and safetyPyName !=''">
				c_safetyPy_name=#{safetyPyName},
			</if>
			<if test="safetyPyType != null and safetyPyType !=''">
				c_safetyPy_type=#{safetyPyType},
			</if>
			<if test="safetyPyRemark != null and safetyPyRemark !=''">
				c_safetyPy_remark=#{safetyPyRemark},
			</if>
			<if test="safetyPyPath != null and safetyPyPath !=''">
				c_safetyPy_path=#{safetyPyPath},
			</if>
			<if test="safetyPyTime != null and safetyPyTime !=''">
				c_safetyPy_time=#{safetyPyTime},
			</if>
			<if test="safetyPyEditusername != null and safetyPyEditusername !=''">
				c_safetyPy_editusername=#{safetyPyEditusername},
			</if>
			<if test="safetyPyAuther != null and safetyPyAuther !=''">
				c_safetyPy_auther=#{safetyPyAuther},
			</if>
			<if test="safetyPyViewcount != null and safetyPyViewcount !=''">
				c_safetyPy_viewcount=#{safetyPyViewcount},
			</if>
		</set>
		where c_safetyPyId=#{safetyPyId}
	</update>
	<update id="updateActiveByViewCount" parameterType="com.jzsx.xlha.bean.SafetyPublicity">
		update t_safety_publicity
		<set>
			<if test="safetyPyViewcount != null and safetyPyViewcount !=''">
				c_safetyPy_viewcount=c_safetyPy_viewcount+1,
			</if>
		</set>
		where c_safetyPyId=#{safetyPyId}
	</update>
	
</mapper>